---
title: "Geyser 已支持 Java 1.20.5/1.20.6"
slug: "geyser-1-20-5"
authors: Camotoy
hide_table_of_contents: false
description: "已发布对 Java 1.20.5 和 1.20.6 的支持"
---

已发布对 Java 1.20.5 和 1.20.6 的支持。感谢您在我们进行更新时的耐心等待！

<!-- truncate -->

## 新增：物品组件

通过网络序列化额外数据的物品 NBT 已成为过去。1.20.5 引入了数据组件，用附加到每个类的严格对象取代了 NBT 的猜测工作。

我们还能够删除服务器库存重写之前无法访问的代码，回到创造模式基岩版仅通过移动物品就有可能从物品中删除 NBT 的时代。

## NBT 重构

由于物品不再具有 NBT，我们决定现在是切换到使用一个 NBT 库的好时机。我们的基岩版协议库使用了 [Cloudburst 的 NBT 实现](https://github.com/CloudburstMC/NBT)，而我们的 Java 协议库使用了 OpenNBT。后者已被严重忽视，仍然存在一些奇怪或过时的实现，例如标签名称存在于标签值对象中。整个项目现在使用 Cloudburst 的 NBT 库，总体而言更易于使用：

```java
boolean piglinSafe = dimension.getBoolean("piglin_safe");
```

变为：

```java
boolean piglinSafe = dimension.getBoolean("piglin_safe");
```

## 更好的标签可扩展性

方块和物品标签现在是枚举 - 这个示例差异显示了添加对_一个_标签的支持...

![标签枚举](/img/blog/2024-05-02-geyser-1-20-5/tag-enums.png)

...现在将在 [ItemTag 类](https://github.com/GeyserMC/Geyser/blob/8b7b8cdffdb7aba97ef817037859d1151f4b2665/core/src/main/java/org/geysermc/geyser/session/cache/tags/ItemTag.java) 中添加一行新的枚举。我们还必须添加一些枚举来支持[数据驱动的动物喜爱的食物](https://github.com/GeyserMC/Geyser/commit/59a2c0dc02abacd00fe3a72788cc9317c891557e)...想象一下使用第一种代码风格的复杂性！

## 不再硬编码锻造配方

由于服务器现在通过一个数据包作为注册表发送所有锻造配方，我们能够摆脱处理锻造配方所需的这段代码。太好了，不再需要硬编码！

![锻造配方](/img/blog/2024-05-02-geyser-1-20-5/trim-recipes.png)

## 实体属性

基岩版较新的[实体属性系统](https://learn.microsoft.com/en-us/minecraft/creator/documents/introductiontoentityproperties?view=minecraft-bedrock-stable)现在已在原版基岩版中找到用途 - 它控制犰狳的动画状态（没有它，犰狳将默认保持在其壳内！）。[Kastle](https://github.com/Kas-tle) 挺身而出，[移植了一些正在进行中的代码](https://github.com/GeyserMC/Geyser/commit/99e6a2981da27a9ec8f09c04cfc8e73a296e4263)，使 Geyser 能够使用新系统。 

## 特别鸣谢

如果没有众多帮助者来实施我们需要完成的所有工作，这次更新将是一场噩梦。

[basaigh](https://github.com/basaigh) 非常及时地实施了 MCProtocolLib 中的巨大物品更改，这意味着 Geyser 可以立即更新自己的代码。

[AJ Ferguson](https://github.com/AJ-Ferguson) 和 [Chris](https://github.com/onebeastchris) 都帮助实施新功能和修复回归问题。

[Kastle](https://github.com/Kas-tle) 在基岩版端更强的安全保护之后，协助了自定义头颅重新实现和实体属性实现。